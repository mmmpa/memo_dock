<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for writer_built/actions/memo.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">writer_built/actions/</a> memo.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">35.8% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>29/81</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/24</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/26</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">35.62% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>26/73</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/// &lt;reference path="../types/tsd.d.ts" /&gt;
var Type = require('../constants/action-types');
var memo_data_1 = require("../models/memo-data");
var login_1 = require("./login");
var request = require('superagent');
<span class="fstat-no" title="function not covered" >function checkLogin(succeed, fail) {</span>
<span class="cstat-no" title="statement not covered" >    if (succeed === void 0) { <span class="cstat-no" title="statement not covered" >succeed = null; </span>}</span>
<span class="cstat-no" title="statement not covered" >    if (fail === void 0) { <span class="cstat-no" title="statement not covered" >fail = null; </span>}</span>
<span class="cstat-no" title="statement not covered" >    return login_1.checkInitialState(succeed, fail);</span>
}
exports.checkLogin = checkLogin;<span class="fstat-no" title="function not covered" ></span>
// メモインデックス取得関係
function index(tagIdNumbers, page) {
<span class="cstat-no" title="statement not covered" >    if (tagIdNumbers === void 0) { <span class="cstat-no" title="statement not covered" >tagIdNumbers = []; </span>}</span>
<span class="cstat-no" title="statement not covered" >    if (page === void 0) { <span class="cstat-no" title="statement not covered" >page = 1; </span>}</span>
<span class="cstat-no" title="statement not covered" >    return <span class="fstat-no" title="function not covered" >function (dispatch) {</span></span>
<span class="cstat-no" title="statement not covered" >        var tag_ids = tagIdNumbers.length ? tagIdNumbers.join(',') : null;</span>
<span class="cstat-no" title="statement not covered" >        dispatch(waitLoadedIndex());</span>
<span class="cstat-no" title="statement not covered" >        request</span>
            .get('/w/api/memos')
            .query({ page: page, tag_ids: tag_ids })
            .end(<span class="fstat-no" title="function not covered" >function (err, res) {</span>
<span class="cstat-no" title="statement not covered" >            if (err) {</span>
            }
            else {
<span class="cstat-no" title="statement not covered" >                dispatch(showIndex(res.body, +res.header.page, +res.header.par, +res.header['total-pages'], res.header['tag-ids']));</span>
            }
        });
    };
}
exports.index = index;
<span class="fstat-no" title="function not covered" >function showIndex(memos, page, par, total, tagIds) {</span>
<span class="cstat-no" title="statement not covered" >    return { type: Type.MEMO_SHOW_INDEX, memos: memos, page: page, par: par, total: total, tagIds: tagIds };</span>
}
<span class="fstat-no" title="function not covered" >function waitLoadedIndex() {</span>
<span class="cstat-no" title="statement not covered" >    return { type: Type.MEMO_WAIT_INDEX };</span>
}<span class="fstat-no" title="function not covered" ></span>
// メモ保存関係
function saveMemo(memo) {
<span class="cstat-no" title="statement not covered" >    var requester = memo.isPersisted()</span>
        ? request.patch('/w/api/memos/' + memo.id)
        : request.post('/w/api/memos/new');
<span class="cstat-no" title="statement not covered" >    return <span class="fstat-no" title="function not covered" >function (dispatch) {</span></span>
<span class="cstat-no" title="statement not covered" >        dispatch(saveMemoStart());</span>
<span class="cstat-no" title="statement not covered" >        requester</span>
            .set('X-CSRF-Token', login_1.token())
            .send({ memo: memo.generateParams() })
            .end(<span class="fstat-no" title="function not covered" >function (err, res) {</span>
<span class="cstat-no" title="statement not covered" >            if (err) {</span>
<span class="cstat-no" title="statement not covered" >                dispatch(saveMemoFail(res.body));</span>
            }
            else {
<span class="cstat-no" title="statement not covered" >                dispatch(saveMemoSucceed(new memo_data_1.default(res.body)));</span>
            }
        });
    };
}
exports.saveMemo = saveMemo;
<span class="fstat-no" title="function not covered" >function saveMemoStart() {</span>
<span class="cstat-no" title="statement not covered" >    return { type: Type.MEMO_START_SAVING };</span>
}
<span class="fstat-no" title="function not covered" >function saveMemoFail(errors) {</span>
<span class="cstat-no" title="statement not covered" >    return { type: Type.MEMO_FAIL_SAVING, errors: errors };</span>
}
<span class="fstat-no" title="function not covered" >function saveMemoSucceed(memo) {</span>
<span class="cstat-no" title="statement not covered" >    return { type: Type.MEMO_SUCCEED_SAVING, memo: memo };</span>
}
<span class="fstat-no" title="function not covered" >function deleteMemo(memo, callback) {</span>
<span class="cstat-no" title="statement not covered" >    return <span class="fstat-no" title="function not covered" >function (dispatch) {</span></span>
<span class="cstat-no" title="statement not covered" >        dispatch(waitLoadedIndex());</span>
<span class="cstat-no" title="statement not covered" >        request</span>
            .delete('/w/api/memos/' + memo.id)
            .set('X-CSRF-Token', login_1.token())
            .end(<span class="fstat-no" title="function not covered" >function (err, res) {</span>
<span class="cstat-no" title="statement not covered" >            if (err) {</span>
<span class="cstat-no" title="statement not covered" >                callback();</span>
            }
            else {
<span class="cstat-no" title="statement not covered" >                callback();</span>
            }
        });
    };
}
exports.deleteMemo = deleteMemo;<span class="fstat-no" title="function not covered" ></span>
// メモ編集画面
function waitLoadedMemo() {
<span class="cstat-no" title="statement not covered" >    return { type: Type.MEMO_WAIT_EDITING };</span>
}
<span class="fstat-no" title="function not covered" >function editMemoById(memoId) {</span>
<span class="cstat-no" title="statement not covered" >    return <span class="fstat-no" title="function not covered" >function (dispatch) {</span></span>
<span class="cstat-no" title="statement not covered" >        dispatch(waitLoadedMemo());</span>
<span class="cstat-no" title="statement not covered" >        request</span>
            .get('/w/api/memos/' + memoId)
            .end(<span class="fstat-no" title="function not covered" >function (err, res) {</span>
<span class="cstat-no" title="statement not covered" >            if (err) {</span>
<span class="cstat-no" title="statement not covered" >                dispatch(injectMemoData(new memo_data_1.default()));</span>
            }
            else {
<span class="cstat-no" title="statement not covered" >                dispatch(injectMemoData(new memo_data_1.default(res.body)));</span>
            }
        });
    };
}
exports.editMemoById = editMemoById;
<span class="fstat-no" title="function not covered" >function editNewMemo() {</span>
<span class="cstat-no" title="statement not covered" >    var memo = new memo_data_1.default();</span>
<span class="cstat-no" title="statement not covered" >    return { type: Type.MEMO_START_EDITING, memo: memo };</span>
}
exports.editNewMemo = editNewMemo;
<span class="fstat-no" title="function not covered" >function injectMemoData(memo) {</span>
<span class="cstat-no" title="statement not covered" >    if (memo === void 0) { <span class="cstat-no" title="statement not covered" >memo = null; </span>}</span>
<span class="cstat-no" title="statement not covered" >    return { type: Type.MEMO_EDIT_NEW_MEMO, memo: memo };</span>
}
<span class="fstat-no" title="function not covered" >function startEditMemo(memo) {</span>
<span class="cstat-no" title="statement not covered" >    return editMemoById(memo.id);</span>
}
exports.startEditMemo = startEditMemo;<span class="fstat-no" title="function not covered" ></span>
// slimのリアルタイムレンダリング
function renderSlim(slim) {
<span class="cstat-no" title="statement not covered" >    return <span class="fstat-no" title="function not covered" >function (dispatch) {</span></span>
<span class="cstat-no" title="statement not covered" >        request</span>
            .post('/w/api/memos/slim')
            .set('X-CSRF-Token', login_1.token())
            .send({ slim: slim })
            .end(<span class="fstat-no" title="function not covered" >function (err, res) {</span>
<span class="cstat-no" title="statement not covered" >            if (err) {</span>
<span class="cstat-no" title="statement not covered" >                dispatch(renderSlimFinish('書式が不正です'));</span>
            }
            else {
<span class="cstat-no" title="statement not covered" >                dispatch(renderSlimFinish(res.body.html));</span>
            }
        });
    };
}
exports.renderSlim = renderSlim;
<span class="fstat-no" title="function not covered" >function renderSlimFinish(html) {</span>
<span class="cstat-no" title="statement not covered" >    return { type: Type.MEMO_FINISH_RENDERING, html: html };</span>
}
exports.renderSlimFinish = renderSlimFinish;
//# sourceMappingURL=memo.js.map</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon Dec 28 2015 04:49:09 GMT+0900 (JST)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
